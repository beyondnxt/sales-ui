<div class="dialog-container">
  <div class="col-lg-12 closeAlign">
    <div>
      <p class="pt-3 pl">Create Task</p>
    </div>
    <div>
      <button mat-icon-button mat-dialog-close tabindex="-1" class="close-button">
        <mat-icon class="closeColor">close</mat-icon>
      </button>
    </div>
  </div>
  <div>
    <mat-radio-group [(ngModel)]="selectedOption" *ngIf="!data">
      <mat-radio-button value="task" (click)="selectOption()">Task</mat-radio-button>
      <mat-radio-button value="visit" (click)="selectOption()">Visit</mat-radio-button>
    </mat-radio-group>
  </div>
  <form action="" [formGroup]="taskDetails" class="taskForm" *ngIf="selectedOption === 'task'">
    <div class="col-lg-12">
      <div class="row">
        <div class="col-lg-6">
          <mat-form-field class="example-full-width">
            <mat-label>
              <input type="text" placeholder="Customer Name" (input)="onInputChange($event)" matInput />
            </mat-label>

            <mat-select formControlName="customerId">
              <mat-option *ngFor="let cus of customerList" [value]="cus.id">
                {{ cus.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="col-lg-6">
          <mat-form-field>
            <mat-label>Task type</mat-label>
            <mat-select formControlName="taskType">
              <mat-option value="Lead">Lead</mat-option>
              <mat-option value="Call Back">Call Back</mat-option>
              <mat-option value="Service">Service</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="col-lg-6">
          <mat-form-field>
            <mat-label>Status</mat-label>
            <mat-select formControlName="status">
              <mat-option *ngIf="!data" value="Unassigned">Unassigned</mat-option>
              <mat-option *ngIf="!data || data.status === 'Unassigned'" value="Assigned">Assigned</mat-option>
              <mat-option *ngIf="data && data.status === 'Assigned'" value="Completed">Completed</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="col-lg-6">
          <mat-form-field>
            <mat-label>Assign To</mat-label>
            <mat-select formControlName="assignTo" [disabled]="taskDetails.get('status')?.value === 'Unassigned'"
              (selectionChange)="onAssignToChange($event)">
              <mat-option *ngFor="let user of userList" [value]="user.id">{{
                user.firstName + " " + user.lastName
                }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="col-lg-6" *ngIf="data?.status == 'Unassigned' || !data">
          <mat-form-field class="full-width flex-end">
            <mat-label>Follow-up Date</mat-label>
            <input #fromDateInput matInput formControlName="followUpDate" [matDatepicker]="fromDatepicker"
              placeholder="From date" />
            <mat-datepicker-toggle matSuffix [for]="fromDatepicker"></mat-datepicker-toggle>
            <mat-datepicker #fromDatepicker></mat-datepicker>
          </mat-form-field>
        </div>
        <div class="col-lg-12">
          <mat-form-field class="example-full-width">
            <mat-label>Description</mat-label>
            <textarea matInput placeholder="" formControlName="description"></textarea>
          </mat-form-field>
        </div>
        <div class="col-lg-12" *ngIf="!data">
          <mat-form-field class="example-full-width">
            <mat-label>Feedback</mat-label>
            <textarea matInput placeholder="" formControlName="feedBack"></textarea>
          </mat-form-field>
        </div>
        <div class="col-lg-12">
          <div class="btnEnd">
            <app-sales-cancel-btn mat-icon-button mat-dialog-close tabindex="-1" class="close-button"
              [label]="'Cancel'"></app-sales-cancel-btn>
            <!-- <ng-container *ngIf="data.status === 'Assigned' && (this.roleName == 'Admin' || userId == data.assignTo)"> -->
              <app-sales-btn *ngIf="showSaveBtn" [label]="'Save'" [isWriteEnabled]="isWriteEnabled" (action)="saveTask()"></app-sales-btn>
            <!-- </ng-container> -->
          </div>
        </div>
      </div>
    </div>
  </form>

  <form action="" [formGroup]="taskDetails" class="taskForm" *ngIf="selectedOption === 'visit'">
    <div class="col-lg-12">
      <div class="row">
        <div class="col-lg-6">
          <mat-form-field class="example-full-width">
            <mat-label>
              <input type="text" placeholder="Customer Name" (input)="onInputChange($event)" matInput />
            </mat-label>
            <mat-select formControlName="customerId">
              <mat-option *ngFor="let cus of customerList" [value]="cus.id">
                {{ cus.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="col-lg-6">
          <mat-form-field>
            <mat-label>Status</mat-label>
            <mat-select formControlName="status">
              <mat-option value="Visit">Visit</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="col-lg-12">
          <mat-form-field class="example-full-width">
            <mat-label>Description</mat-label>
            <textarea matInput placeholder="" formControlName="description"></textarea>
          </mat-form-field>
        </div>
        <div class="col-lg-12" *ngIf="!data">
          <mat-form-field class="example-full-width">
            <mat-label>Feedback</mat-label>
            <textarea matInput placeholder="" formControlName="feedBack"></textarea>
          </mat-form-field>
        </div>
        <div class="col-lg-12">
          <div class="btnEnd">
            <app-sales-cancel-btn mat-icon-button mat-dialog-close tabindex="-1" class="close-button"
              [label]="'Cancel'"></app-sales-cancel-btn>
            <app-sales-btn [isWriteEnabled]="isWriteEnabled" [label]="'Save'" (action)="saveTask()"></app-sales-btn>
          </div>
        </div>
      </div>
    </div>
  </form>
</div>